<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cafekiosk</title>
    <link rel="stylesheet" href="kiosk.css" />
    <style></style>
  </head>
  <body>
    <!-- HTML -->
    <div class="wrap">
      <div class="order_menu">
        <h2>원하시는 음료를 선택해 주세요</h2>
        <p id="plesae">Please choose the drink you want.</p>
        <div class="section1">
          <h2 id="menuH2">COFFEE</h2>
          <div id="menubox"></div>
        </div>
      </div>
      <div class="left_menu">
        <div class="order_list">
          <div class="section2">
            <h2>주문내역</h2>
            <div id="orderbox"></div>
          </div>
        </div>
        <div class="order_result01">
          <h2>총 주문금액 : <span id="pay"></span></h2>
          <!-- <span class="line">&boxv;</span> -->
          <button class="btn">결 제</button>
        </div>
      </div>
    </div>

    <!-- JavaScript -->
    <script>
      // 메뉴 정보 데이터
      let menus = [
        { id: 0, name: '아메리카노', type: 'HOT', price: 1000, quantity: 1 },
        { id: 1, name: '아메리카노', type: 'ICE', price: 1300, quantity: 1 },
        { id: 2, name: '바닐라라떼', type: 'HOT', price: 2500, quantity: 1 },
        { id: 3, name: '바닐라라떼', type: 'ICE', price: 2800, quantity: 1 },
        { id: 4, name: '연유라떼', type: 'HOT', price: 2500, quantity: 1 },
        { id: 5, name: '연유라떼', type: 'ICE', price: 2800, quantity: 1 },
        {
          id: 6,
          name: '카라멜마끼아또',
          type: 'HOT',
          price: 2800,
          quantity: 1,
        },
        {
          id: 7,
          name: '카라멜마끼아또',
          type: 'ICE',
          price: 3000,
          quantity: 1,
        },
        { id: 8, name: '카페모카', type: 'HOT', price: 3000, quantity: 1 },
        { id: 9, name: '카페모카', type: 'ICE', price: 3300, quantity: 1 },
        { id: 10, name: '딥카페라테', type: 'HOT', price: 3400, quantity: 1 },
        { id: 11, name: '딥카페라테', type: 'ICE', price: 3700, quantity: 1 },
      ];

      // menubox에 출력할거임
      let menubox = document.getElementById('menubox');
      let liImg = document.getElementById('liImg');
      let pay = document.getElementById('pay');
      let orderbox = document.getElementById('orderbox');
      let cartarr = []; //1차원 빈배열 생성

      // 메뉴 선택시 주문내역에 나오게
      // 1차원 배열이름 = []; //빈 1차원 배열 생성하는 방식
      // let cart4 = [1,2,3] //1차원에 값이 입력된 배열
      // let cart2 = new Array(); //1차원 빈배열

      // javaSCript 버전 6이상 읽어 들이는 브라우저에서 사용 가능
      // let cart3 = Array.from(Array(2), () => new Array(3)); //2x3 2차원 빈배열 생성
      // let cart6 = Array.from(Array(2), () => new Array(3).fill(1)); //2x3 2차원 1채원진 배열 생성

      function renderMenu() {
        let result01 = '';
        // 항목 나열을 위한 ul / li
        result01 += `<ul id="coffeeUi">`;
        // 이미지 출력 ICE/HOT에 대한 if
        for (let i = 0; i < menus.length; i++) {
          if (menus[i].type === 'HOT') {
            result01 += `
                <li onclick="menuClick(${i})" class="coffeeLi">
                  <span>${menus[i].type}</span>
                  <img src= "img/hot.png" alt="${menus[i].name}"/>
                  <p>${menus[i].name}</p>
                  <p>${menus[i].price.toLocaleString('ko-kr')}원</p>
                </li>`;
          } else {
            result01 += `
                <li onclick="menuClick(${i})" class="coffeeLi">
                  <span>${menus[i].type}</span>
                  <img src= "img/ice.png" alt="${menus[i].name}"/>
                  <p>${menus[i].name}</p>
                  <p>${menus[i].price.toLocaleString('ko-kr')}원</p>
                </li>`;
          }
        }
        result01 += `</ul>`;
        // 출력
        menubox.innerHTML = result01;
        // console.log(result01);
      }
      // 호출
      renderMenu();

      // 주문내역
      let index = 0; //초기화
      function menuClick(orderNo) {
        let result02 = '';
        result02 += `<ul class="cartUi">`;
        // 선택한 메뉴 출력 위치
        // 총 금액 출력 위치
        let pay = document.getElementById('pay');
        // 주문내역에 담기
        for (let i = 0; i < menus.length; i++) {
          if (i === orderNo) {
            cartarr.push({
              id: menus[i].id,
              name: menus[i].name,
              type: menus[i].type,
              price: menus[i].price,
              quantity: menus[i].quantity,
            });
            menuClickList();
          }
          result02 += `</ul>`;
        }
        allTotal();
      }

      // menuClick(orderNo) 함수를 2개로 분리하여 menuClickList()함수 생성
      function menuClickList() {
        orderbox.innerHTML = '';
        for (let i = 0; i < cartarr.length; i++) {
          orderbox.innerHTML += `
              <li class="cartLi">
                <div class = "cartDiv">
                  <p>${cartarr[i].name}</p> <span>&nbsp;(${
            cartarr[i].type
          }) </span><p class="ordercnt" pindex="${i}">&nbsp;-&nbsp;${
            cartarr[i].quantity}개</p>
                  </div>
                  <p class="orderprice" priceindex="${i}">
                    ${cartarr[i].price.toLocaleString('ko-kr')}원</p>
                <button class="remove" onclick="removeBtn(${i})">x</button>
                <div class="Btndiv">
                  <button class="plus" onclick="plusBtn(${i})">▲</button>
                  <button class="minus" onclick="minusBtn(${i})">▼</button>
                </div>
              </li>`;
        }
      }

      // 총 주문 금액
      function allTotal(index) {
        let total = 0;
        for (let i = 0; i < cartarr.length; i++) {
          total += cartarr[i].price * cartarr[i].quantity;
        }
        pay.innerHTML = `${total.toLocaleString('ko-kr')}원`;
        menuClick();
      }

      // 수량 up 버튼
      function plusBtn(index) {
        let ordercnt = document.querySelector(`.ordercnt[pindex="${index}"]`);
        let orderprice = document.querySelector(
          `.orderprice[pindex="${index}"]`
        );
        if (cartarr[index].quantity < 10) {
          cartarr[index].quantity++;
          ordercnt.textContent = cartarr[index].quantity;
          orderprice.textContent =
            cartarr[index].quantity * cartarr[index].quantity;
        } else {
          alert(
            '수량은 10개까지만 가능합니다. 대량 주문은 카운터로 문의 바랍니다.'
          );
        }
        allTotal();
      }
      // 수량 down 버튼
      function minusBtn(index) {
        let ordercnt = document.querySelector(`.ordercnt[pindex="${index}"]`);
        let orderprice = document.querySelector(
          `.orderprice[pindex="${index}"]`
        );
        if (cartarr[index].quantity > 1) {
          cartarr[index].quantity--;
          ordercnt.textContent = cartarr[index].quantity;
          orderprice.textContent =
            cartarr[index].quantity * cartarr[index].quantity;
        } else {
          alert('최소 수량은 1개 입니다.');
        }
        allTotal();
      }

      // 삭제 버튼
      function removeBtn(index) {
        cartarr.splice(index, 1);
        menuClickList();
        // cartarr.remove();
        // orderbox.innerHTML = '';
        allTotal();
      }
    </script>
  </body>
</html>
