<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>달력</title>
    <style>
        body{
            margin: 20px auto;
            text-align: center;
            display: flex;
            justify-content: center;
        }
        #data-warp{
            display: flex;
            gap: 30px;
            justify-content: space-between;
            margin-bottom: 20px;
            color: #7248e4;
        }
        button{
            border: none;
            background-color: transparent;
            color: #9874fc;
            cursor: pointer;
        }
        #displayTable{
            display: flex;
            justify-content: center;
        }
        th{
            color: #7248e4;
            padding: 0 5px;
        }
        td{
            padding: 3px 12.5px;
            color: #7248e4;
        }
        td:hover{
            background-color: #fffbee;
        }
    </style>
</head>
<body>
    <!-- 달력 MTHL 구조 -->
     <div id="container">
         <div id="data-warp">
            <!-- 이전 버튼 -->
            <button id="previousButton" onclick="previousButton()">◀</button>
            <!-- 년도/월 -->
             <div id="main-data"></div>
             <!-- 이후 버튼 -->
              <button id="nextButton" onclick="nextButton()">▶</button>
        </div>
        <table id="data-week">
            <thead>
                <th>SUN</th>
                <th>MON</th>
                <th>TUE</th>
                <th>WED</th>
                <th>THU</th>
                <th>FRI</th>
                <th>SAT</th>
            </thead>
        </table>
        <!-- 달력 날짜 값 -->
        <div id="displayTable"></div>
     </div>

     <!-- script -->
    <script>
        // document 변수 만들기
        // 전역변수
        let yearMonth = document.getElementById('main-data');
        let displayTable = document.getElementById('displayTable');
        let today = new Date();  // 오늘 날짜/시간

        // 2차원 배열 지정
        let arr = Array.from(Array(6),()=>new Array(7));

        // 달력의 배열에 값을 저장하는 함수
        function calender(){
            // 1. 올해 년도 출력하는 변수
            let year = today.getFullYear();  // ex) 2025
            // 2. 월 출력하는 변수
            let month = today.getMonth();  // ex) 8 = 9월
            // 3. 이달의 마지막 일자 구하기
            //    일의 0을 지정하면 그 전달의 마지막 일자 출력
            // new Date(2025, 5, 0) -> 2025-4-30 출력
            let lastDate = new Date(year, month + 1, 0);  // +1을 한 이유 : 인덱스 번호상 1씩 밀려야하기 때문!
            //    마지막 일자 출력 하는 변수
            let lastDay = lastDate.getDate();
            // 4. 이달의 시작일 1의 요일 구하기
            // getDay() : 일요일 = 0 ~ 토요일 = 6
            // 1월 = 0 / 12월 = 11
            // 일을 구하는 변수
            let startDate = new Date(year, month, 1);
            // 당해 년도 월의 시작일자 1
            let startDay = startDate.getDate();
            // 당해 년도 월의 시작일자의 요일
            let startWeek = startDate.getDay();

            // 가로 시작
            let row = 0;

            // 배열 초기화
            // 안 할시 undefind 출력됨. 반드시 초기화하기
            for(let i=0; i<arr.length; i++){
                for(let j=0; j<arr[i].length; j++){
                    arr[i][j]='';
                }
            }

            // 핵심 코드
            // 달력 배열에 실제 날짜를 채우는 핵심 로직
            // ┎ i는 시작일, j는 마지막 일자 31일까지 루프 돌리라는 뜻
            for(let i=startDay; i<=lastDay; i++){
                // 현재 달의 1일부터 마지막 날짜까지 반복
                // ex) day = 0, startWeek = 5 일때 => arr[0][5] 0열의 5행인 금요일 자리에 1!
                arr[row][startWeek] = i;

                // 7일이 되면 줄바꿈
                // startWeek : 7 < 6
                if(startWeek < arr[row].length-1){
                    // 만약에 현재요일이 6(토요일)이 아니면
                    startWeek++;
                }else{
                    // 현재 요일이 토요일이면 한 주가 끝난 것.
                    // 다음 행으로 이동
                    row++;
                    // startWeek를 0으로 리셋
                    startWeek=0;
                }
            }
        }

        // display() 호출하여 화면 출력
        // dispay();
        // display 출력하는 함수 작성
        function dispay(){
            // 반드시 해야하는 작업 - 달력 호출
            calender();
            let tb = '<table class="cal_table">';
            // 가로줄
            for(let i=0; i<arr.length; i++){
                tb += '<tr>';
                // 세로줄
                for(let j=0; j<arr[i].length; j++){
                    tb += '<td>' + arr[i][j] + '</td>';
                }
                tb += '</tr>';
            }
            tb += '</table>';

            // 상단의 년도/월 입력
            let yearmon = today.getFullYear() + '년' + (today.getMonth()+1) + '월';
            yearMonth.innerHTML = yearmon;

            // 배열의 달력
            displayTable.innerHTML = tb;
        }
        
        dispay();

        // 이전버튼 클릭시 날짜의 월이 -1씩 줄어들면 된다.
        function previousButton(){
            today = new Date(today.getFullYear(),today.getMonth()-1, 1);
            dispay();
        }
        function nextButton(){
            today = new Date(today.getFullYear(),today.getMonth()+1, 1);
            dispay();
        }
    </script>
</body>
</html>